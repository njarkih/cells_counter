# Детекция клеток с помощью computer vision

На текущий момент многие лаборатории и производства занимающиеся клеточными технологиями сталкиваются с необходимостью количественного контроля клеток в ходе процесса их выращивания. Клеточные технологии применяются довольно широко в условиях фармацевтических производств. Их используют, к примеру для получения инсулина, интерферона, различных вакцин, гормонов, антител и тд.

В данной работе производится подсчёт клеток яичника китайского хомячка. В ходе своего роста и развития, клетки делятся, потребляют питательные вещества и производят метаболиты. Одним из очень важных параметров роста клеточной культуры является показатель их жизнеспособности. Для его оценки в условиях фарм производства необходимо ежедневно брать пробы клеток и проводить их подсчет. Для подсчета используют несколько методов, первый и самый простой это отбор пробы, ее дальнейшее окрашивание и ручной подсчет с помощью микроскопа в счетной камере.

<img src="https://github.com/njarkih/cells_counter/blob/main/presentation/cells_example.PNG" width="200" height="200">

Более современным вариантом является использование каунтеров, это автоматические системы, требующие наличие специфической и достаточно дорогой расходки

Для сбора датасета мы отправились в лабораторию клеточных технологий при Технопарке РТУ МИРЭА, образец культуральной суспензии предоставила компания АО Генериум. Было сделано более 250 фоток, но при этом только 68 были достаточного качества для разметки. 

Результат разметки:
  - Клеток всего 4584
  - Живых клеток 4102
  - Мертвых клеток 482

После окончания разметки мы перешли к выбору модели, выбирали из 3 вариантов это YOLO, UNET и FasterRCNN.
Результат YOLO был не так хорош. Для UNET - существует большое количество научных статей на тему ее применения к медицинским и биологическим данным и в принципе модель должна была хорошо справиться с поставленной задачей, но в нашем случае она показала результат хуже чем у RCNN. А вот на предобученной RCNN результаты сразу были достаточно хорошие.

Таким образом наш выбор это faster-RCNN модель. В начале модель плохо распознавала даже живые клетки, но ближе к тысячной эпохе модель распознает не только живые но и мертвые клетки. Так как классы были не сбалансированы, мы исскуственно увеличили количество мертвых клеток.

Процесс обучения:

<img src="https://github.com/njarkih/cells_counter/blob/main/presentation/learning_process.PNG" width="400" height="400">

Модель была имплементированна в форме сайта на Flask, с использованием JavaScript, опубликованный на GOOGLE Cloud.

Работа сайта представлена ниже:

![Output sample](https://github.com/njarkih/cells_counter/blob/main/presentation/Cells.gif)
